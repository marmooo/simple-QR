function loadConfig(){localStorage.getItem("darkMode")==1&&(document.documentElement.dataset.theme="dark")}function toggleDarkMode(){localStorage.getItem("darkMode")==1?(localStorage.setItem("darkMode",0),delete document.documentElement.dataset.theme):(localStorage.setItem("darkMode",1),document.documentElement.dataset.theme="dark")}function playAudio(c,b){const a=audioContext.createBufferSource();if(a.buffer=c,b){const c=audioContext.createGain();c.gain.value=b,c.connect(audioContext.destination),a.connect(c),a.start()}else a.connect(audioContext.destination),a.start()}function unlockAudio(){audioContext.resume()}function loadAudio(a){return fetch(a).then(a=>a.arrayBuffer()).then(a=>new Promise((b,c)=>{audioContext.decodeAudioData(a,a=>{b(a)},a=>{c(a)})}))}function loadAudios(){const a=[loadAudio("/simple-QR/mp3/correct3.mp3")];Promise.all(a).then(a=>{correctAudio=a[0]})}function tick(a){if(loadingMessage.textContent="âŒ› Loading video...",video.readyState===video.HAVE_ENOUGH_DATA)if(loadingMessage.hidden=!0,canvasElement.hidden=!1,canvasElement.height=video.videoHeight,canvasElement.width=video.videoWidth,canvas.drawImage(video,0,0,canvasElement.width,canvasElement.height),a-prevTime>500){prevTime=a;const b=canvas.getImageData(0,0,canvasElement.width,canvasElement.height);worker.postMessage({data:b.data,width:b.width,height:b.height})}requestAnimationFrame(tick)}function iosCopyToClipboard(a){if(a=typeof a=="string"?document.querySelector(a):a,navigator.userAgent.match(/ipad|ipod|iphone/i)){const d=a.contentEditable,e=a.readOnly;a.contentEditable=!0,a.readOnly=!0;const b=document.createRange();b.selectNodeContents(a);const c=window.getSelection();c.removeAllRanges(),c.addRange(b),a.setSelectionRange(0,999999),a.contentEditable=d,a.readOnly=e}else a.select();document.execCommand("copy")}function copyToClipboard(){const a=document.createElement("textarea");document.body.appendChild(a),a.value=outputData.textContent,iosCopyToClipboard(a),document.body.removeChild(a),alert("OK!")}loadConfig();const AudioContext=window.AudioContext||window.webkitAudioContext,audioContext=new AudioContext;loadAudios();let correctAudio,prevTime=0;const video=document.createElement("video"),canvasElement=document.getElementById("canvas"),canvas=canvasElement.getContext("2d"),loadingMessage=document.getElementById("loadingMessage"),navMessage=document.getElementById("navMessage"),outputMessage=document.getElementById("outputMessage"),outputData=document.getElementById("outputData"),worker=new Worker("/simple-QR/koder.js");worker.onmessage=b=>{const a=b.data.data;if(a){navMessage.hidden=!0,outputMessage.hidden=!1,outputData.parentElement.hidden=!1,outputData.textContent=a;try{new URL(a),outputData.href=a}catch{}playAudio(correctAudio)}},navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(b){const a=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return a?new Promise(function(c,d){a.call(navigator,b,c,d)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(function(a){video.srcObject=a,video.setAttribute("playsinline",!0),video.play(),requestAnimationFrame(tick)}).catch(function(a){alert(a.message)}),document.getElementById("toggleDarkMode").onclick=toggleDarkMode;const copyToClipboardButton=document.getElementById("copyToClipboard");copyToClipboardButton&&(copyToClipboardButton.onclick=copyToClipboard),document.addEventListener("click",unlockAudio,{once:!0,useCapture:!0})